[[server]]
name = "f9-nas"
[server.config]
enabled = true

##

[[stack]]
name = "ai"
[stack.config]
server = "f9-nas"
git_account = "fma965"
repo = "fma965/f9-homelab"
run_directory = "docker/stacks/ai"

##

[[stack]]
name = "default"
[stack.config]
server = "f9-nas"
git_account = "fma965"
repo = "fma965/f9-homelab"
run_directory = "docker/stacks/default"

##

[[procedure]]
name = "f9-homelab"

[[procedure.config.stage]]
name = "Stage"
enabled = true
executions = [
  { execution.type = "RunSync", execution.params.sync = "f9-homelab", enabled = true }
]

[[procedure.config.stage]]
name = "Stage"
enabled = true
executions = [
  { execution.type = "BatchDeployStackIfChanged", execution.params.pattern = "*", enabled = true }
]

##

[[alerter]]
name = "Discord"
[alerter.config]
enabled = true
endpoint.type = "Discord"
endpoint.params.url = "[[OP__KOMODO__MONITORING__DISCORD_WEBHOOK]]"
alert_types = [
  "ServerCpu",
  "ServerUnreachable",
  "StackStateChange",
  "ContainerStateChange",
  "ProcedureFailed",
  "ResourceSyncPendingUpdates"
]

##

[[builder]]
name = "local"
[builder.config]
type = "Server"
params = {}

##

[[resource_sync]]
name = "f9-homelab"
[resource_sync.config]
repo = "fma965/f9-homelab"
git_account = "fma965"
resource_path = ["docker/komodo.toml"]
managed = true
delete = true